#include <Wire.h>
#include <SPI.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define OLED_MOSI   11 //D1
#define OLED_CLK   12 //D0
#define OLED_DC    9 //DC
#define OLED_CS    8 //CS
#define OLED_RESET 10 //RES
#define fsr_pin A0
Adafruit_SSD1306 display(OLED_MOSI, OLED_CLK, OLED_DC, OLED_RESET, OLED_CS);
const int ledCount = 8;    // the number of LEDs in the bar graph
int ledPins[] = { 1,2,3,4,5,6,7,13};  


static const unsigned char PROGMEM Logo[]={
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x01,0xff,0xfc,0x00,0x00,0x00,
  0x00,0x01,0xf3,0xff,0xfe,0x7c,0x00,0x00,
  0x00,0x01,0xfb,0xfc,0xff,0x7c,0x00,0x00,
  0x00,0x01,0xfb,0xf0,0x7e,0x7c,0x00,0x00,
  0x00,0x01,0xd8,0xfd,0xfc,0xdc,0x00,0x00,
  0x00,0x00,0xee,0x7f,0xf3,0xbc,0x00,0x00,
  0x00,0x00,0xf3,0x1f,0xe6,0x7c,0x00,0x00,
  0x00,0x00,0xf9,0xcf,0x8c,0xf8,0x00,0x00,
  0x00,0x00,0xee,0xe7,0x1b,0xb8,0x00,0x00,
  0x00,0x00,0xf3,0x68,0x36,0x78,0x00,0x00,
  0x00,0x00,0x7d,0xed,0xbc,0xf0,0x00,0x00,
  0x00,0x00,0x3e,0x7f,0xb3,0xe0,0x00,0x00,
  0x00,0x00,0x0f,0xb7,0xb7,0x80,0x00,0x00,
  0x00,0x00,0x67,0xf7,0x7f,0x30,0x00,0x00,
  0x00,0x00,0x71,0xe7,0x3c,0x70,0x00,0x00,
  0x00,0x00,0x78,0x07,0x00,0x70,0x00,0x00,
  0x00,0x00,0x38,0x07,0x00,0x70,0x00,0x00,
  0x00,0x00,0x3c,0x37,0x61,0xf0,0x00,0x00,
  0x00,0x00,0x3e,0x77,0x73,0xf0,0x00,0x00,
  0x00,0x00,0x3e,0xf7,0x7b,0xf0,0x00,0x00,
  0x00,0x00,0x3e,0xf7,0x7b,0xe0,0x00,0x00,
  0x00,0x00,0x3e,0xf6,0x7b,0xe0,0x00,0x00,
  0x00,0x00,0x3e,0xf0,0x7b,0xe0,0x00,0x00,
  0x00,0x00,0x3e,0xff,0xfb,0xe0,0x00,0x00,
  0x00,0x00,0x1e,0xff,0xfb,0xc0,0x00,0x00,
  0x00,0x00,0x06,0xe0,0x3b,0x00,0x00,0x00,
  0x00,0x00,0x02,0xef,0x3a,0x00,0x00,0x00,
  0x00,0x00,0x00,0xcf,0xb8,0x00,0x00,0x00,
  0x00,0x00,0x00,0x1f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  };
static const unsigned char PROGMEM Logo2[]={
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x1e,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x3f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0xff,0xc0,0x00,0x00,0x00,
  0x00,0x00,0x00,0xff,0xc0,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0xc0,0x00,0x00,0x00,
  0x00,0x00,0x00,0x1f,0xc0,0x00,0x00,0x00,
  0x00,0x00,0x00,0x3f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x0c,0x7f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x0f,0xff,0x82,0x00,0x00,0x00,
  0x00,0x00,0x13,0xff,0x07,0x00,0x00,0x00,
  0x00,0x00,0x1f,0xfc,0x06,0x00,0x00,0x00,
  0x00,0x00,0x3f,0xfe,0x03,0x00,0x00,0x00,
  0x00,0x00,0x19,0xff,0x03,0x00,0x00,0x00,
  0x00,0x00,0x08,0xff,0x83,0x00,0x00,0x00,
  0x00,0x00,0x08,0x7f,0xc3,0x00,0x00,0x00,
  0x00,0x00,0x04,0x3f,0xe3,0x00,0x00,0x00,
  0x00,0x00,0x04,0x1f,0xfe,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0xfc,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0xfc,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0f,0xec,0x00,0x00,0x00,
  0x00,0x00,0x00,0x07,0xc8,0x00,0x00,0x00,
  0x00,0x00,0x01,0xf7,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x9f,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,
  0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x06,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x0c,0x00,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
  };
  
void setup()
{
  Serial.begin(115200);
  display.begin(SSD1306_SWITCHCAPVCC);
  display.clearDisplay();
  display.drawBitmap(23,0,Logo,64,32,WHITE);
  display.display();

  for (int thisLed = 0; thisLed < ledCount; thisLed++) {
    pinMode(ledPins[thisLed], OUTPUT);
   }

}

void loop()
{
  int fsr_value = analogRead(fsr_pin); // 讀取FSR
  int led_value = map(fsr_value, 0, 1023, 0, 10); // 從0~1023映射到0~10
  for (int thisLed = 0; thisLed < ledCount; thisLed++) {
    if (thisLed < led_value) {
      digitalWrite(ledPins[thisLed], HIGH);
     }
   else {
      digitalWrite(ledPins[thisLed], LOW);
     }
   }
   if (fsr_value>=0 && fsr_value<=512){
      display.clearDisplay();
      display.drawBitmap(23,0,Logo,64,32,WHITE);
      display.display();
    }
    else{
      display.clearDisplay();
      display.drawBitmap(23,0,Logo2,64,32,WHITE);
      display.display();
    }
    //Serial.println(fsr_value);
}




